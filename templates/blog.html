{% extends "base.html" %}

{% block title %}{{ translations['blog'] }} - Marcin Piotrowski{% endblock %}

{% block content %}
<section>
    {% if posts %}
    {% if total_pages > 1 %}
    <nav class="pagination pagination-top" aria-label="Blog pagination - top">
        <div class="pagination-container">
            {% if has_prev %}
            <a href="/?page={{ prev_page }}" class="pagination-button pagination-prev">
                <i class="fa fa-chevron-left"></i> {{ translations.get('previous', 'Poprzednia') }}
            </a>
            {% else %}
            <button class="pagination-button pagination-prev" disabled>
                <i class="fa fa-chevron-left"></i> {{ translations.get('previous', 'Poprzednia') }}
            </button>
            {% endif %}

            <span class="pagination-info">
                <strong>{{ ((current_page - 1) * posts_per_page) + 1 }}-{{ [current_page * posts_per_page, total_posts]|min }}</strong> / <span>{{ total_posts }}</span>
            </span>

            {% if has_next %}
            <a href="/?page={{ next_page }}" class="pagination-button pagination-next">
                {{ translations.get('next', 'Następna') }} <i class="fa fa-chevron-right"></i>
            </a>
            {% else %}
            <button class="pagination-button pagination-next" disabled>
                {{ translations.get('next', 'Następna') }} <i class="fa fa-chevron-right"></i>
            </button>
            {% endif %}
        </div>
    </nav>
    {% endif %}

    <div class="blog-list">
        {% for post in posts %}
        <article class="blog-card">
            <h2>
                {% if lang == 'pl' %}
                    <a href="/blog/{{ post.slug }}">{{ post.title_pl }}</a>
                {% else %}
                    <a href="/blog/{{ post.slug }}">{{ post.title_en }}</a>
                {% endif %}
            </h2>
            <div class="blog-card-meta">
                <div class="blog-meta-item">
                    <i class="fa fa-calendar"></i>
                    <span class="meta-label">{{ translations['published'] }}:</span>
                    <time datetime="{{ post.date }}">{{ post.date_formatted }}</time>
                </div>
                {% if post.updated_formatted %}
                <div class="blog-meta-item">
                    <i class="fa fa-pencil"></i>
                    <span class="meta-label">{{ translations['updated'] }}:</span>
                    <time datetime="{{ post.updated }}">{{ post.updated_formatted }}</time>
                </div>
                {% endif %}
                {% if post.author %}
                <div class="blog-meta-item">
                    <i class="fa fa-user"></i>
                    <span class="meta-label">{{ translations['author'] }}:</span>
                    <span>{{ post.author }}</span>
                </div>
                {% endif %}
            </div>
            {% if post.tags and post.tags|length > 0 %}
            <div class="blog-card-tags">
                <i class="fa fa-tags"></i>
                {% for tag in post.tags %}
                <span class="tag-small">{{ tag }}</span>
                {% endfor %}
            </div>
            {% endif %}
            <p class="blog-description">
                {% if lang == 'pl' %}
                    {{ post.description_pl }}
                {% else %}
                    {{ post.description_en }}
                {% endif %}
            </p>
            <a href="/blog/{{ post.slug }}" class="read-more-link">
                {{ translations['read_more'] }} →
            </a>
        </article>
        {% endfor %}
    </div>

    {% if total_pages > 1 %}
    <nav class="pagination pagination-bottom" aria-label="Blog pagination - bottom">
        <div class="pagination-container">
            {% if has_prev %}
            <a href="/?page={{ prev_page }}" class="pagination-button pagination-prev">
                <i class="fa fa-chevron-left"></i> {{ translations.get('previous', 'Poprzednia') }}
            </a>
            {% else %}
            <button class="pagination-button pagination-prev" disabled>
                <i class="fa fa-chevron-left"></i> {{ translations.get('previous', 'Poprzednia') }}
            </button>
            {% endif %}

            <span class="pagination-info">
                <strong>{{ ((current_page - 1) * posts_per_page) + 1 }}-{{ [current_page * posts_per_page, total_posts]|min }}</strong> / <span>{{ total_posts }}</span>
            </span>

            {% if has_next %}
            <a href="/?page={{ next_page }}" class="pagination-button pagination-next">
                {{ translations.get('next', 'Następna') }} <i class="fa fa-chevron-right"></i>
            </a>
            {% else %}
            <button class="pagination-button pagination-next" disabled>
                {{ translations.get('next', 'Następna') }} <i class="fa fa-chevron-right"></i>
            </button>
            {% endif %}
        </div>
    </nav>
    {% endif %}

    {% else %}
    <p class="no-posts">{{ translations['no_posts'] }}</p>
    {% endif %}
</section>
{% endblock %}
